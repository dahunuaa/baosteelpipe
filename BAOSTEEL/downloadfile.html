<!--<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8"/>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
		<meta name="HandheldFriendly" content="true"/>
		<meta name="MobileOptimized" content="320"/>
		<title>Hello H5+</title>
		<script type="text/javascript" src="js/common.js"></script>
		<script type="text/javascript" src="js/defined_downloadfile.js" ></script>
		<script type="text/javascript">
var dtask=null;
var fileName = "Baosteel_app_train_1474355241838_57.pdf";


function createDownloadTask(){
	if ( dtask ) {
		outLine( "下载任务已创建！" );
		return;
	}
    var url = "http://121.42.186.54:8081/uploadfiles/Baosteel_app_train_1474355241838_57.pdf";
    
    var options = {method:"GET",filename:"_doc/"+fileName};
	dtask = plus.downloader.createDownload( url,options);
	dtask.start();
	
}
function startDownloadTask(){
	if ( !dtask ) {
		outSet( "请先创建下载任务！" );
		return;
	}
	dtask.start();
}

function openTask(){
	plus.runtime.openFile("_doc/"+fileName, {},function(e){
    			plus.nativeUI.toast("打开文件")
    })
}
	


// 暂停下载任务
function pauseDownloadTask(){
    dtask.pause();
    outSet( "暂停下载！" );
}
// 恢复下载任务
function resumeDownloadTask(){
    dtask.resume();
    outSet( "恢复下载！" );
}
function cancelDownloadTask(){
	dtask.abort();
	dtask = null;
	outSet( "取消下载任务！" );
}
function clearDownloadTask(){
	
}
function startAll(){
	plus.downloader.startAll();
}
		</script>
		<link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8"/>
	</head>
	<body>
		<header id="header">
			<div class="nvbt iback" onclick="back(true);"></div>
			<div class="nvtt">Downloader</div>
			<div class="nvbt idoc" onclick="openDoc('Downloader Document','/doc/downloader.html')"></div>
		</header>
		<div id="dcontent" class="dcontent">
			<br/>
			<ul class="dlist">
				<li class="ditem" onclick="createDownloadTask();">创建下载任务</li>
				<li class="ditem" onclick="startDownloadTask();">启动下载任务</li>
				<li class="ditem" onclick="pauseDownloadTask();">暂停下载任务</li>
				<li class="ditem" onclick="resumeDownloadTask();">恢复下载任务</li>
				<li class="ditem" onclick="cancelDownloadTask();">取消下载任务</li>
				<li class="ditem" onclick="openTask();">打开文件</li>
				<!--<li class="ditem" onclick="clearDownloadTask();">清除所有任务</li>-->
			<!--</ul>
		</div>
		<div id="output">
Downloader用于管理文件的下载，可从网络下载各种文件，并支持跨域访问。
		</div>
	</body>
	<script type="text/javascript" src="js/immersed.js" ></script>
</html>-->
	
	
	
<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8"/>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>Hello H5+</title>
		<link href="css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8"/>
		<link rel="stylesheet" type="text/css" href="css/app.css"/>
	</head>
		<body>
		<header class="mui-bar mui-bar-nav">
		    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
		    <h1 class="mui-title">下载文件</h1>
		</header>
		<div class="mui-content" style="margin-top: 20px;">
			<input type="button" onclick="createDownloadTask()" value="启动下载任务">
			<input type="button" onclick="openTask()" value="打开文件">
			<br/>
			<span>下载进度：</span><span id="processtext"></span>
			
		</div>
			
		<script type="text/javascript" src="js/app.js" ></script>
		<script type="text/javascript" src="js/mui.js" ></script>
		<script type="text/javascript" src="js/immersed.js" ></script>
		<script type="text/javascript">
		  
			var processtext = document.getElementById("processtext")
			var dtask=null;
			var fileName="Baosteel_app_train_1474355241838_57.pdf";
			function createDownloadTask(){
				if ( dtask ) {
					outLine( "下载任务已创建！" );
					return;
				}
			    var url = "http://121.42.186.54:8081/uploadfiles/Baosteel_app_train_1474355241838_57.pdf";
			    var options = {method:"GET",filename:"_doc/"+fileName};
				dtask = plus.downloader.createDownload( url, options );
			    dtask.addEventListener( "statechanged", function(task,status){
			    	if(!dtask){return;}
			    	switch(task.state) {
			    		case 1: // 开始
			    			plus.nativeUI.toast("开始下载...");			    			
			    		break;
			    		case 2: // 已连接到服务器
			    			plus.nativeUI.toast("开始下载...");
			    		break;
			    		case 3:	// 已接收到数据
							processtext.innerHTML=task.downloadedSize+"/"+task.totalSize;
			    			
			    		break;
			    		case 4:	// 下载完成			    			
			    			processtext.innerHTML=parseInt(task.totalSize/1024)+"KB"
			    			plus.nativeUI.toast("下载完成!");
			    		break;
			    	}
			    } );

			    dtask.start();
			    				    
			}
			function openTask(){
				plus.runtime.openFile("_doc/"+fileName, {},function(e){
			    			plus.nativeUI.toast("打开文件")
			    })
			}
		</script>
		</body>	
</html>
